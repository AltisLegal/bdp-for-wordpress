<div class="property-single__inner">
  <h1 class="property-single__title" data-title="{houseNo} {streetName}, {town}, {postcode}">{houseNo} {streetName}, {town}, {postcode}</h1>
  <div class="type">{bedRooms} bedroom {pType}</div>
  <ul class="property-single__tabs">
    <li class="active"><a href="#tab-1" data-toggle="tab">Photos</a></li>
    <li><a href="#tab-2" data-toggle="tab">Map</a></li>
    <li><a href="#tab-3" data-toggle="tab">Streetview</a></li>
  </ul>
  <div class="row-fluid">
    <div class="span12">
        <div id="tab-1" class="detail-tab active">
          <div class="slider-for">
            {imgString}
          </div>
          <div class="slider-nav">
            {imgString}
          </div>
      </div>
      <div id="tab-2" class="detail-tab">
        <div class="bdd-detailMapsSize">
          <div id="bdf-propertyMap" class="bdd-detailMapsSize"> </div>
        </div>
          <script type="text/javascript">
            var propertyMapData = {outputMapDataString};
            //var locationMapData = [{localInfo}];
            var locationMapData = '';
            var markerURL = '{markerURL}';
            var gmapStyle = '{gmapStyle}';
            //Property details tabs
          </script>
      </div>
      <div id="tab-3" class="detail-tab">
        <div id="bdf-sView" class="bdd-detailMapsSize"> </div>
        <script type="text/javascript">
            var propertyMapData = {outputMapDataString};
            var markerURL = '{markerURL}';
            jQuery('a[data-toggle="tab"]').on('shown.bs.tab', function () {
              initializemap();
            });
          </script>
      </div>
    </div>
  </div>
  <div class="row-fluid row-property--details">
    <div class="span8">
      <h3>About the property</h3>
      <div class="summary" data-summary="{summaryText}" style="display:none;"></div>
      <div class="description">
        {descText}
      </div>
    </div>
    <div class="span4">
      <div class="price">{priceType} {outputAskingPrice}</div>
      <div class="statusflag bdpstatus{statusId} branch{branch_id}">{sellingStatus}</div>
      <div class="information">
        <h4>Information</h4>
        <ul class="features">
          <li>Bedrooms<br />{bedRooms}</li>
          <li>Bathrooms<br />{bathRooms}</li>
          <li>Living Rooms<br />{livingRooms}</li>
          <li>EPC<br />{epcBand}</li>
        </ul>
      </div>
      <div class="viewing bump{viewingDetails}">
        <h4>Viewing Information</h4>
        <ul class="features">
          <li><div class="viewingdetails">{viewingDetails}</div></li>
        </ul>
      </div>
      <div class="contact">
        <h4>Contact</h4>
        <ul class="features">
          <li class="bump{staffNeg_proPic}"><div class="staff-photo"><img src="https://uat.bdphq.com/index.php?bdimg={staffNeg_proPic}&w=128&h=128&q=90"/></div></li>
          <li><div class="name">{staffNeg_firstName} {staffNeg_lastName}</div></li>
          <li><div class="number">{staffNeg_workTel1}</div></li>
          <li><div class="email"><a href="mailto:{staffNeg_userNme}">{staffNeg_userNme}</a></div></li>
        </ul>
      </div>
      <div class="resources">
        <a class="button bump{brochurePathPublic}" href="{brochurePathPublic}" target="_blank"><span>Brochure</span></a>
        <a class="button bump{floorPlanPdfPathPublic}" href="{floorPlanPdfPathPublic}" target="_blank"><span>Floor Plan</span></a>
        <a class="button" data-toggle="modal" data-target="#espchr"><span>Request a Home Report</span></a>
        <a class="button" href="#" data-toggle="modal" data-target="#bookViewing"><span>Book a viewing</span></a>
      </div>
    </div>
  </div>
</div>

<!------- Home Report  -------->
<div class="modal " id="espchr" tabindex="-1" role="dialog" aria-labelledby="espchr" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <h4 class="modal-title" id="myModalLabel">Request Home Report for:<br/>
          {dispAddress}</h4>
      </div>
      <div class="modal-body">
        <form id="homeReport" class="form-horizontal bdf-homeReportForm">
          <div class="form-group">
            <label class="col-sm-3 control-label" for="name">Your First Name</label>
            <div class="col-sm-7">
              <input class="form-field" placeholder="Enter your first name :" type="text" name="firstName">
            </div>
          </div>
          <div class="form-group">
            <label class="col-sm-3 control-label" for="name">Your Last Name</label>
            <div class="col-sm-7">
              <input class="form-field" placeholder="Enter your last name :" type="text" name="lastName">
            </div>
          </div>
          <div class="form-group">
            <label class="col-sm-3 control-label" for="email">Email address</label>
            <div class="col-sm-7">
              <input class="form-field" placeholder="Enter your email :" type="email" name="email">
            </div>
          </div>
          <div class="form-group">
            <label class="col-sm-3 control-label" for="tel">Phone Number</label>
            <div class="col-sm-7">
              <input class="form-field" placeholder="Enter your phone number" type="text" name="tel1">
            </div>
          </div>
          <div class="form-group">
            <label class="col-sm-3 control-label" for="message">Message</label>
            <div class="col-sm-7">
              <textarea class="form-field" placeholder="Type a message :" rows="7" name="message"></textarea>
            </div>
          </div>
          <div class="form-group">
            <div id="RecaptchaHomeReport"></div>
          </div>
          <div class="form-group">
            <div class="col-sm-7" style="margin-top: 20px;">
              <input type="hidden" name="propaddress" id="propaddress" value="{dispAddress}">
              <button type="submit" class="btn btn-default bdf-Submit">Send message</button>
              <button type="button" class="btn btn-default bdf-cancel x-btn" data-dismiss="modal">Cancel</button>
            </div>
          </div>
          <div class="commentsdcoy">
            <label class="col-sm-3 control-label" for="comments">Leave next field empty</label>
            <input type="text" name="comments">
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<!------- Viewing Request  -------->
<div class="modal " id="bookViewing" tabindex="-1" role="dialog" aria-labelledby="bookViewing" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <h4 class="modal-title" id="myModalLabel">Request a Viewing for:<br/>
          {dispAddress}</h4>
      </div>
      <div class="modal-body">
        <form id="bViewing" class="form-horizontal bdf-requestViewingForm">
          <div class="form-group">
            <label class="col-sm-3 control-label" for="name">Your First Name</label>
            <div class="col-sm-7">
              <input class="form-field" placeholder="Enter your first name :" type="text" name="firstName">
            </div>
          </div>
          <div class="form-group">
            <label class="col-sm-3 control-label" for="name">Your Last Name</label>
            <div class="col-sm-7">
              <input class="form-field" placeholder="Enter your last name :" type="text" name="lastName">
            </div>
          </div>
          <div class="form-group">
            <label class="col-sm-3 control-label" for="email">Email address</label>
            <div class="col-sm-7">
              <input class="form-field" placeholder="Enter your email :" type="email" name="email">
            </div>
          </div>
          <div class="form-group">
            <label class="col-sm-3 control-label" for="tel">Phone Number</label>
            <div class="col-sm-7">
              <input class="form-field" placeholder="Enter your phone number" type="text" name="tel1">
            </div>
          </div>
          <div class="form-group">
            <label class="col-sm-3 control-label" for="message">Message</label>
            <p style="color:#FF0000">Please indicate two preferred dates and times for viewing</p>
            <div class="col-sm-7">
              <textarea class="form-field" placeholder="Type a message :" rows="7" name="message"></textarea>
            </div>
          </div>
          <!--<div class="form-group">
            <div id="RecaptchaBookViewing"></div>
          </div>-->
          <div class="form-group">
            <div class="col-sm-7" style="margin-top: 20px;">
              <input type="hidden" name="propaddress" id="propaddress" value="{dispAddress}">
              <button type="submit" class="btn btn-default bdf-Submit">Send message</button>
              <button type="button" class="btn btn-default bdf-cancel x-btn" data-dismiss="modal">Cancel</button>
            </div>
          </div>
          <div class="commentsdcoy">
            <label class="col-sm-3 control-label" for="comments">Leave next field empty</label>
            <input type="text" name="comments">
          </div>
        </form>
        <!-- -->
      </div>
    </div>
  </div>
</div>

<script>
  jQuery('a[data-toggle="tab"]').on('shown.bs.tab', function() {

    initializemap();

  });

  closingdate = '{closingDate}';

  if (closingdate !== '') {
    // get today's date
    today = Math.floor(Date.now() / 1000);
    //console.log(today)

    var date = new Date(closingdate * 1000);
    var hours = date.getHours();
    var minutes = "0" + date.getMinutes();
    var days = date.getDate();
    var months = (date.getMonth() + 1);
    var years = date.getFullYear();

    outputtext = '';
    closingdateformatted = days + '/' + months + '/' + years + ' at ' + hours + ':' + minutes.substr(-2);
    daydiff = Math.round((closingdate - today) / (60 * 60 * 24));
    if (daydiff < 0) {
      outputtext = "";
      closingdateformatted = '';
      jQuery("#closinginfo.hide()");
    }
    if (daydiff == 0) {
      outputtext = "Closing date today"
    }
    if (daydiff == 1) {
      outputtext = daydiff + " day to closing date"
    }
    if (daydiff > 1) {
      outputtext = daydiff + " days to closing date"
    }


    console.log(daydiff);

    jQuery(".closingMessage").text(outputtext);
    jQuery(".closingDate").text(closingdateformatted);
  }
</script>

<script type="text/javascript">
  var CaptchaCallback = function() {
    grecaptcha.render('RecaptchaHomeReport', {
      'sitekey': '6LdPnUMUAAAAAHmzkJklERLqDRPi31i0sjfp7KxY'
    });
    grecaptcha.render('RecaptchaBookViewing', {
      'sitekey': '6LdPnUMUAAAAAHmzkJklERLqDRPi31i0sjfp7KxY'
    });
  };
</script>
